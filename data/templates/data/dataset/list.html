{% extends "data/base.html" %}

{% block title %}Global City Data{% endblock %}

{% block content %}
  <h1 class="my-4">Global City Data</h1>
  {# Search Form #}
  <form method="post" id="searchForm">
    {% csrf_token %}
    {{ searchForm }}
    <input class="btn btn-outline-primary my-4" type="submit" name="search" value="Search">
  </form>
  {# Query Form #}
  <form method="post" id="queryForm">
    {% csrf_token %}
    <div class="form-group">
      {% for field in queryForm %}
        {# Show all fields #}
        <div class="form-control">
          <label class="form-control-label" for="topic">{{ field.label }}</label>
          {{ field }}
        </div>
        {# Show errors #}
        <div class="text-danger small">
          {{ field.errors }}
        </div>
      {% endfor %}
      <input class="btn btn-outline-primary my-4" type="submit" value="Search" name="query">
    </div>
  </form>
  <hr>
  {# Datasets #}
  <section id="datasets">
    <h1 class="my-4">Datasets</h1>
    <div class="row">
      {% for dataset in datasets %}
        <section class="col-md-4 my-3">
          <div class="card h-100">
            <h3 class="card-header">{{ dataset.title }}</h3>
            <div class="card-body d-flex flex-column">
              {#<h4 class="card-title">Description</h4>#}
              <p class="card-text">{{ dataset.description|truncatewords:30 }}</p>
              <a href="{{ dataset.get_absolute_url }}" class="btn btn-primary mt-auto">Dataset Detail</a>
            </div>
          </div>
        </section>
      {% empty %}
        <p class="m-4">There are no datasets that match your query.</p>
      {% endfor %}
    </div>
  </section>

{% endblock %}